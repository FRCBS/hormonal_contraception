---
title: "DAG for anemia in FinOCC"
author: "Mikko Arvas"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(DiagrammeR)
library(ggdag)
library(causaleffect)
library(igraph)
library(tidyverse)
library(dagitty)
library(ggdag)
library(tidygraph)
```

TODO:


-what do we do with age and time ? Can we break loops with some timing?

  
  -if we consider only women with out kids does age matter for inflammatory status, choise of HC or something else ?
  
  
  - Eeva said
  
    -younger are more likely to get combination pills, they can used to treat acne and menstrual disorders and combination pill raise risk of venous thromboembolism
  
    -for progestine pills age should not matter
    
    -> so there is age affect but also possibly the age effect depends on the hc type
    
  -how about how long a product has been used? the longer you have used it the more time it has had to have an effect? and this also is dependent on age. Could Muriel give me some pointers on how to address it? Could it be a percentage of age or is an interaction better as the estimate really don't matter? Do we have the dates of when the products were ordered? Or should we do a survival analysis?
  
-should we add a propensity score analysis with a score on how likely one is to use HC

-trial emulation?

# Functions

```{r}
from_ggdag_2_diagrammer <- function(ggdag.object) {
  tmp <- tidy_dagitty(ggdag.object)$data
 #tmp <- tidy_dagitty(anemia_dag)$data
  edges <- tmp %>% 
    select(name, to) %>% 
    rename("from"="name") %>% 
    na.omit()
  
   nodes <- tmp %>% 
   select(name,label) %>%
   #  select(name) %>% 
   rename("id"="name") %>%
   distinct() %>%
   na.omit()
  g <- create_graph(
    directed = TRUE,
    attr_theme = "tb"
  )
  g<- add_nodes_from_table(g,
                           table = nodes,
                           label_col = label)
  g <- add_edges_from_table(graph =g,
                            table=edges,
                            from_col = from,
                            to_col = to,
                            from_to_map=id_external)
  invisible(g)
}

```


```{r}
from_ggdag_2_igraph <- function(dagify.object) {
  tmp <- tidy_dagitty(dagify.object)$data
  tmp <- tmp %>% select(name, to) %>% 
  as.matrix() %>% # igraph wants a matrix
  na.omit() #there was A -> NA , maybe to spesify outcome
  tmp <- graph_from_edgelist(tmp, directed = TRUE)
  invisible(tmp)
}

```


# Pastricha DAG with hormonal contraception

Based on "Iron deficiency" 
Sant-Rayn Pasricha, Jason Tye-Din, Martina U Muckenthaler, Dorine W Swinkels 2021 Lancet
http://dx.doi.org/10.1016/S0140-6736(20)32594-0

```{r}

pastricha_dag <- ggdag::dagify(
  II ~ VD, # Low haem iron content (eg, from a vegetarian or vegan diet)
  II ~ ConInh, # Concomitant consumption of inhibitors of iron absorption (eg, calcium or tea)
  II ~ InAcid, # Inadequate acidification
  II ~ InMyc, # Intestinal mycosal dysfunction
  IS ~ II, #When iron intake is inadequate to meet requirements or to compensate for physiological or pathological losses, body iron stores become depleted
  A ~ Iinfl, #In patients with inflammation, withholding of iron from the plasma promotes iron deficient erythropoiesis and anaemia despite adequate body iron stores (functional iron deficiency). Obesity
  A ~ IS, # Absolute ID occurs when iron stores are insufficient to meet the needs of the individual, and is particularly common in young children (younger than 5 years) and premenopausal (especially pregnant) women
  IS ~ Mens,  # The main causes of absolute ID are excessive blood loss...
  Mens ~ HC,
  IS ~ InLoss,  # Gastrointestinal blood loss is the most important cause of ID in men and postmenopausal women
  IS ~ BD,
  IS ~ Cb,
  Cb ~ Pre,
  
  
  
  labels = c(
    "A" = 'Iron\ndeficiency\nanemia',
    "HC" = 'Use/Choise\nof HC',
    "Mens"= 'Menstruation' ,
    "Pre" = 'Pregnancy' ,
    "Cb" = 'Child\nbirth' ,
    "II" = 'Iron\nintake',
    "IS" = 'Iron\nstores',
   "Iinfl" = 'Inflammation',
   "InLoss" = 'Gastrointestinal\nblood loss',
   "Erosion" = "Erosion",
   "CC" = 'Colon cancer',
   "InflBo" = 'Inflamatory bowel disease',
   "BD" = 'Blood\ndonation',
   "ConInh" = 'Consumption\nof inhibitors',
   "InMyc" = 'Intestinal\ndysfunction',
   "InAcid" = 'Inadequate\nacidification',
   "VD" = 'Low\niron\ndiet'
   
  ),
  exposure = "HC",
  outcome = "A"
)

pastricha_dag.diag <- from_ggdag_2_diagrammer(pastricha_dag)
render_graph(
  pastricha_dag.diag, 
#  layout="tree"
)
```

```{r}
latents(pastricha_dag) <- c("II","IS")
exposures(pastricha_dag) <- c("HC")
outcomes(pastricha_dag) <- c("A")

```


```{r}
ggdag_adjustment_set(pastricha_dag)
#how to define the latent variables to get the corract adjustement set
```

‘Backdoor Paths Unconditionally Closed’ means that, assuming the DAG we have drawn is correct, we may obtain an unbiased estimate of X on Y without including additional variables.

```{r}
ggdag_instrumental(pastricha_dag)
```

# Pastricha DAG with added complexity


```{r}

pastricha_dag_mens <- ggdag::dagify(
  II ~ VD, # Low haem iron content (eg, from a vegetarian or vegan diet)
  II ~ ConInh, # Concomitant consumption of inhibitors of iron absorption (eg, calcium or tea)
  II ~ InAcid, # Inadequate acidification
  II ~ InMyc, # Intestinal mycosal dysfunction
  II ~ Edu, # education level is associated with iron intake
  Inc ~ Edu, # education level is associated with income
  Res ~ Inc, # place of residence is associated with income level
  IS ~ II, #When iron intake is inadequate to meet requirements or to compensate for physiological or pathological losses, body iron stores become depleted
  IS ~ IID, # increased iron demand can cause body iron stores to be depleted, if iron intake is inadequate
  IID ~ Exe, # exercise causes iron demand
  IID ~ Lac, # lactation increases iron demand
  IID ~ Pre, # pregnancy increases iron demand
  A ~ Iinfl, #In patients with inflammation, withholding of iron from the plasma promotes iron deficient erythropoiesis and anaemia despite adequate body iron stores (functional iron deficiency). Obesity
  A ~ IS, # Absolute ID occurs when iron stores are insufficient to meet the needs of the individual, and is particularly common in young children (younger than 5 years) and premenopausal (especially pregnant) women
  IS ~ Mens,  # The main causes of absolute ID are excessive blood loss...
  Mens ~ HC,
  IS ~ InLoss,  # Gastrointestinal blood loss is the most important cause of ID in men and postmenopausal women
  InLoss ~ IBD, # IBD causes GI blood loss
  Iinfl ~ IBD, # IBD causes inflammation
  Iinfl ~ RA, # rheumatoid arthritis causes inflammation
  Iinfl ~ asthma, 
  InMyc ~ IBD, # IBD causes intestinal dysfunction (through inflammation?)
  InMyc ~ GBP, # gastric bypass, particularly Roux-en-Y, causes food to bypass duodenum.  
  InMyc ~ CD, # celiac disease
  InMyc ~ HP, # H. Pylori
  IS ~ BD, # Blood donation can cause iron deficiency
  BD ~ IS, # If you are low own iron you can't get to donate 
  IS ~ Cb, # childbirth affects iron stores
  IS ~ MC, # miscarriage affects iron stores
  IS ~ Ab, # abortion affects iron stores
  Cb ~ Pre, 
  Ab ~ Pre, 
  MC ~ Pre, 
  Pre ~ HC, 
  Pre ~ Edu, # education level is associated with (age of first) pregnancy
  Mens ~ IS, # Your iron store can influence your menstruation
  Mens ~ HMB, # heavy menstrual bleeding
  Mens ~ ED, # eating disorders effect on HPO axis
  II ~ ED, 
  Mens ~ hypth, # hypothyroidism effect on HPO axis
  HMB ~ PALM, # structural causes for HMB
  HMB ~ COEIN, # non-structural causes for HMB
  HC ~ Iinfl, # obesity and mentabolic disease can influence your choise of HC
  HC ~ Age, # age affect your choice of contraception, should there HC X age interaction
  HC ~ Edu, # education level affects the choice of HC
  HC ~ Res, # some regions may offer free HC for certain age groups
  HC ~ Contr, # contraindication for HC use
  HC ~ Tera, # teratogens (tretinoin, lithium)
  HC ~ HMB, 
  HC ~ Acne,
  HC ~ Smoking,
  VE ~ Smoking, # smoking risk factor for venous thorombosis
  AE ~ Smoking, # smoking risk factor for arterial thorombosis
  Contr ~ RR, # uncontrolled hypertension (1yr exclusion after dx?)
  Contr ~ VE, #  venous thrombosis (-> exclude DVT, PE)
  Contr ~ AE, # arterial thrombosis (-> exclude stroke, TIA, ACS)
  Contr ~ Migr, # aural migraine
  Contr ~ DI, # drug interactions (antiepileptics)
  Iinfl ~ Age, # the older you are the more inflamed you get, "spline"?
  Iinfl ~ MBO, # metabolisc syndrome
  Iinfl ~ Smoking, 
  RR ~ Smoking,
  MBO ~ RR, 
  MBO ~ Ob, # obesity risk factor for MBO
  HMB ~ Ob, # obesity risk factor for HMB
  Ca ~ Iinfl, # low grade inflammation -> cancer
  A ~ Ca, # cancer causes anemia
  A ~ Age, # due to iron requirements of growth younger women tend to be more iron deficient aas they have not yet requperated from growth. Should this be a "spline" ? 
 
  labels = c(
    "A" = 'Iron\ndeficiency\nanemia',
    "IID" = 'Increased\niron\ndemand',
    "HC" = 'HC use\nand type',
    "Contr" = 'Contraindication\n for HC use',
    "RR" = 'Hypertension',
    "AE" = 'Arterial\nthrombosis',
    "VE" = 'Venous\nthrombosis',
    "Migr" = 'Aural\nmigraine',
    "DI" = 'Drug\ninteractions',
    "Tera" = 'Teratogens',
    "MBO" = 'MBO',
    "Ca" = 'Cancer',
    "Ob" = 'Obesity',
    "PALM" = 'PALM',
    "COEIN" = 'COEIN',
    "Ab" = 'Abortion',
    "MC" = 'Miscarriage',
    "ED" = 'Eating\ndisorder',
    "Acne" = 'Acne',
    "IBD" = 'IBD',
    "hypth" = 'Hypo-\nthyroidism',
    "GBP" = 'Gastric\nbypass',
    "Smoking" = 'Smoking',
    "asthma" = 'Asthma',
    "RA" = 'Rheumatoid\narthritis',
    "Exe" = 'Exercise',
    "Lac" = 'Lactation',
    "Mens"= 'Menstruation' ,
    "Pre" = 'Pregnancy' ,
    "Cb" = 'Child\nbirth' ,
    "II" = 'Iron\nintake',
    "Inc" = 'Income',
    "Edu" = 'Education\nlevel',
    "Res" = 'Place of\nresidence',
    "IS" = 'Iron\nstores',
   "Iinfl" = 'Inflammation',
   "InLoss" = 'Gastrointestinal\nblood loss',
    "CD" = 'Celiac\ndisease',
    "HP" = 'H. Pylori',
   "CC" = 'Colon cancer',
   "InflBo" = 'Inflamatory bowel disease',
   "BD" = 'Blood\ndonation',
   "ConInh" = 'Consumption\nof inhibitors',
   "InMyc" = 'Intestinal\ndysfunction',
   "InAcid" = 'Inadequate\nacidification',
   "VD" = 'Low\niron\ndiet',
   "Age" = 'Age',
   "HMB" = 'HMB\nN92'
   
  ),
  exposure = "HC",
  outcome = "A"
)

# tried to change node colours herem but this does not work? I wanted factors directly related to IDA to be a separate colour 
# pastricha_dag <- pastricha_dag %>% 
#    set_node_attrs(node = c("Age"), color = "pink")


pastricha_dag.diag <- from_ggdag_2_diagrammer(pastricha_dag_mens)
render_graph(
  pastricha_dag.diag, 
#  layout="tree"
)
```




```{r}
latents(pastricha_dag_mens) <- c("II","IS")
exposures(pastricha_dag_mens) <- c("HC")
outcomes(pastricha_dag_mens) <- c("A")

```


```{r}
ggdag_adjustment_set(pastricha_dag_mens)
#how to define the latent variables to get the corract adjustement set
```




```{r}
ggdag_instrumental(pastricha_dag_mens)
```



# Pastricha DAG with added complexity and exclusions

Child birth and pregnancy create backdoor paths. Exclude all data prior to first pregnancy.
Use of hormonal contraception to treat excessive menstrual flow. Exclude persons with excessive menstrual flow.
Similarly cancer could cause all kinds of loops so all persons with cancer diagnosis are best excluded.

```{r}
pastricha_dag_mens_no <- ggdag::dagify(
  II ~ VD, # Low haem iron content (eg, from a vegetarian or vegan diet)
  II ~ ConInh, # Concomitant consumption of inhibitors of iron absorption (eg, calcium or tea)
  II ~ InAcid, # Inadequate acidification
  II ~ InMyc, # Intestinal mycosal dysfunction
  IS ~ II, #When iron intake is inadequate to meet requirements or to compensate for physiological or pathological losses, body iron stores become depleted
  A ~ Iinfl, #In patients with inflammation, withholding of iron from the plasma promotes iron deficient erythropoiesis and anaemia despite adequate body iron stores (functional iron deficiency). Obesity
  A ~ IS, # Absolute ID occurs when iron stores are insufficient to meet the needs of the individual, and is particularly common in young children (younger than 5 years) and premenopausal (especially pregnant) women
  IS ~ Mens,  # The main causes of absolute ID are excessive blood loss...
  Mens ~ HC,
  IS ~ InLoss,  # Gastrointestinal blood loss is the most important cause of ID in men and postmenopausal women
  IS ~ BD, # Blood donation can cause iron deficiency
  BD ~ IS, # If you are low own iron you can't get to donate 
  Mens ~ IS, # Your iron store can influence your menstruation
  HC ~ Iinfl, # obesity and mentabolic disease can influence your choise of HC
  HC ~ Age, # age affect your choice of contraception, should there HC X age interaction
  Iinfl ~ Age, # the older you are the more inflamed you get, "spline"?
  A ~ Age, # due to iron requirements of growth younger women tend to be more iron deficient aas they have not yet requperated from growth. Should this be a "spline" ? 
 
  labels = c(
    "A" = 'Iron\ndeficiency\nanemia',
    "HC" = 'Use/Choise\nof HC',
    "Mens"= 'Menstruation' ,
    "Pre" = 'Pregnancy' ,
    "Cb" = 'Child\nbirth' ,
    "II" = 'Iron\nintake',
    "IS" = 'Iron\nstores',
   "Iinfl" = 'Inflammation',
   "InLoss" = 'Gastrointestinal\nblood loss',
   "Erosion" = "Erosion",
   "CC" = 'Colon cancer',
   "InflBo" = 'Inflamatory bowel disease',
   "BD" = 'Blood\ndonation',
   "ConInh" = 'Consumption\nof inhibitors',
   "InMyc" = 'Intestinal\ndysfunction',
   "InAcid" = 'Inadequate\nacidification',
   "VD" = 'Low\niron\ndiet',
   "Age" = 'Age'
   
  ),
  exposure = "HC",
  outcome = "A"
)

pastricha_dag.diag <- from_ggdag_2_diagrammer(pastricha_dag_mens_no)
render_graph(
  pastricha_dag.diag, 
#  layout="tree"
)
```


```{r}
latents(pastricha_dag_mens_no) <- c("II","IS")
exposures(pastricha_dag_mens_no) <- c("HC")
outcomes(pastricha_dag_mens_no) <- c("A")

```


```{r}
ggdag_adjustment_set(pastricha_dag_mens_no)
```


```{r}
ggdag_instrumental(pastricha_dag_mens_no)
```

# FINAL DAG: Pastricha DAG with added complexity and exclusions + FinnReg & complexity

- Associations for iron deficiency anemia derived from FinnReg added. Some conditions associated with iron deficiency are uncommon in this age group, and have therefore not been included.
- Factors influencing contraception choice and use globally: a synthesis of systematic reviews by D’Souza et al. 2022 (https://doi.org/10.1080/13625187.2022.2096215)
"We found 24 systematic reviews of mostly moderate or high quality. Factors affecting contraception use are remarkably similar among women in very different cultures and settings globally. Use of contraception is influenced by the perceived likelihood and appeal of pregnancy, and relationship status. It is influenced by women’s knowledge, beliefs, and perceptions of side effects and health risks. Male partners have a strong influence, as do peers’ views and experiences, and families’ expectations. Lack of education and poverty is linked with low contraception use, and social and cultural norms influence contraception and expectations of family size and timing. Contraception use also depends upon their availability, the accessibility, confidentiality and costs of health services, and attitudes, behaviour and skills of health practitioners."

```{r}
pastricha_dag_mens_no_fr <- ggdag::dagify(
  #IS ~ II, #When iron intake is inadequate to meet requirements or to compensate for physiological or pathological losses, body iron stores become depleted
  A ~ Iinfl, #In patients with inflammation, withholding of iron from the plasma promotes iron deficient erythropoiesis and anaemia despite adequate body iron stores (functional iron deficiency). Obesity
  #A ~ IS, # Absolute ID occurs when iron stores are insufficient to meet the needs of the individual, and is particularly common in young children (younger than 5 years) and premenopausal (especially pregnant) women
  A ~ Mens,  # The main causes of absolute ID are excessive blood loss...
  Mens ~ HC,
  A ~ InLoss,  # Gastrointestinal blood loss is the most important cause of ID in men and postmenopausal women
  InLoss ~ IBD, # IBD causes GI blood loss
  Iinfl ~ IBD, # IBD causes inflammation
  Iinfl ~ asthma, 
  A ~ BD, # Blood donation can cause iron deficiency
  A ~ Cb, # childbirth affects iron stores
  A ~ MC, # miscarriage affects iron stores
  A ~ Ab, # abortion affects iron stores
  A ~ ED, # eating disorders addect iron stores
  Cb ~ Pre, 
  Ab ~ Pre, 
  MC ~ Pre, 
  Pre ~ HC, 
  #Mens ~ IS, # Your iron store can influence your menstruation
  Mens ~ HMB, # heavy menstrual bleeding
  Mens ~ ED, # eating disorders effect on HPO axis
  Mens ~ hypth, # hypothyroidism effect on HPO axis
  HMB ~ PALM, # structural causes for HMB
  HMB ~ COEIN, # non-structural causes for HMB
  HC ~ Age, # age affect your choice of contraception, should there HC X age interaction
  HC ~ Contr, # contraindication for HC use
  HC ~ Tera, # teratogens (tretinoin, lithium)
  HC ~ HMB, 
  HC ~ Acne,
  HC ~ Smoking,
  Contr ~ RR, # uncontrolled hypertension (1yr exclusion after dx?)
  Contr ~ VE, #  venous thrombosis (-> exclude DVT, PE)
  Contr ~ AE, # arterial thrombosis (-> exclude stroke, TIA, ACS)
  Contr ~ Migr, # aural migraine
  Contr ~ DI, # drug interactions (antiepileptics)
  Iinfl ~ MBO, # metabolisc syndrome
  Iinfl ~ Smoking, 
  RR ~ Smoking,
  VE ~ Smoking,
  AE ~ Smoking,
  MBO ~ Ob, # obesity risk factor for MBO
  HMB ~ Ob, # obesity risk factor for HMB
  Iinfl ~ Ca, # low grade inflammation -> cancer
  A ~ Ca, # cancer causes anemia
  A ~ Age, # due to iron requirements of growth younger women tend to be more iron deficient aas they have not yet requperated from growth. Should this be a "spline" ? 
 
  labels = c(
    "A" = 'Iron\ndeficiency\nanemia',
    "HC" = 'Use/Choise\nof HC',
    "Contr" = 'Contraindication\n for HC use',
    "RR" = 'Hypertension',
    "AE" = 'Arterial\nthrombosis',
    "VE" = 'Venous\nthrombosis',
    "Migr" = 'Aural\nmigraine',
    "DI" = 'Drug\ninteractions',
    "Tera" = 'Teratogens',
    "MBO" = 'MBO',
    "Ca" = 'Cancer',
    "Ob" = 'Obesity',
    "PALM" = 'PALM',
    "COEIN" = 'COEIN',
    "Ab" = 'Abortion',
    "MC" = 'Miscarriage',
    "ED" = 'Eating\ndisorder',
    "Acne" = 'Acne',
    "IBD" = 'IBD',
    "hypth" = 'Hypo-\nthyroidism',
    "GBP" = 'Gastric\nbypass',
    "Smoking" = 'Smoking',
    "asthma" = 'Asthma',
    # "" = '',
    "Mens"= 'Menstruation' ,
    "Pre" = 'Pregnancy' ,
    "Cb" = 'Child\nbirth' ,
    "II" = 'Iron\nintake',
    "IS" = 'Iron\nstores',
   "Iinfl" = 'Inflammation',
   "InLoss" = 'Gastrointestinal\nblood loss',
   "CC" = 'Colon cancer',
   "InflBo" = 'Inflamatory bowel disease',
   "BD" = 'Blood\ndonation',
   "ConInh" = 'Consumption\nof inhibitors',
   "InMyc" = 'Intestinal\ndysfunction',
   "InAcid" = 'Inadequate\nacidification',
   "VD" = 'Low\niron\ndiet',
   "Age" = 'Age',
   "HMB" = 'HMB\nN92'
   
  ),
  exposure = "HC",
  outcome = "A"
)

pastricha_dag.diag <- from_ggdag_2_diagrammer(pastricha_dag_mens_no_fr)
render_graph(
  pastricha_dag.diag, 
#  layout="tree"
)
```

Inflammation increases risk of anemia but is not an observable variable in our study. However, as many factors involved in the DAG cause inflammation it cannot be a latent variable and needs to be adjusted for. To  

```{r}
latents(pastricha_dag_mens_no_fr) <- c("Mens", "Smoking", "BD", "Pre", "DI") 
exposures(pastricha_dag_mens_no_fr) <- c("HC")
outcomes(pastricha_dag_mens_no_fr) <- c("A")

```


```{r}
ggdag_adjustment_set(pastricha_dag_mens_no_fr)
```
Inflammation increases risk of anemia but is not an observable variable in our study. Instead, we will adjust for factors that cause inflammation.  


```{r}
ggdag_instrumental(pastricha_dag_mens_no_fr)
```

# Dagitty

```{r}
library(dagitty)

g <- dagitty('dag {
bb="-5.138,-7.891,4.859,6.577"
"Contraindications of HC" [pos="3.753,-2.147"]
"Education level" [pos="-1.893,-2.436"]
"HC use and type" [exposure,pos="0.468,-2.881"]
"Heavy menstrual bleeding (PALM-COEIN)" [pos="-1.613,-1.085"]
"Iron intake" [latent,pos="-3.967,-1.649"]
"Metabolic syndrome" [pos="-0.494,3.132"]
"Place of residence" [pos="0.099,-6.685"]
"Relationship status" [pos="3.402,-5.250"]
Abortion [pos="-3.973,2.750"]
Age [pos="2.933,-0.209"]
Cancer [pos="3.586,2.317"]
Childbirth [pos="-2.588,4.014"]
Hypothyroidism [pos="-4.305,0.375"]
IBD [pos="0.758,5.372"]
IDA [outcome,pos="-0.344,1.038"]
Income [pos="-1.318,-5.170"]
Inflammation [latent,pos="2.083,2.791"]
Miscarriage [latent,pos="0.191,3.885"]
Obesity [latent,pos="1.496,0.268"]
Pregnancy [pos="-1.984,0.769"]
Smoking [latent,pos="4.026,0.666"]
"Contraindications of HC" -> "HC use and type"
"Education level" -> "HC use and type"
"Education level" -> "Iron intake"
"Education level" -> Income
"Education level" -> Pregnancy
"HC use and type" -> "Heavy menstrual bleeding (PALM-COEIN)"
"HC use and type" -> IDA
"HC use and type" -> Pregnancy
"Heavy menstrual bleeding (PALM-COEIN)" -> IDA
"Iron intake" -> IDA
"Metabolic syndrome" -> Inflammation
"Place of residence" -> "HC use and type"
"Relationship status" -> "HC use and type"
Abortion -> IDA
Age -> "Contraindications of HC"
Age -> IDA
Age <-> Inflammation
Cancer -> IDA
Childbirth -> IDA
Hypothyroidism -> "Heavy menstrual bleeding (PALM-COEIN)"
Hypothyroidism -> IDA
IBD -> IDA
IBD -> Inflammation
Income -> "HC use and type"
Income -> "Place of residence"
Inflammation -> Cancer
Inflammation -> IDA
Miscarriage -> IDA
Obesity -> "Contraindications of HC"
Obesity -> "Heavy menstrual bleeding (PALM-COEIN)"
Obesity -> "Metabolic syndrome"
Obesity -> Cancer
Obesity -> Inflammation
Pregnancy -> Abortion
Pregnancy -> Childbirth
Pregnancy -> IDA
Pregnancy -> Miscarriage
Smoking -> "Contraindications of HC"
Smoking -> IDA
Smoking -> Inflammation
}')
plot(g)
```

```{r}
# all paths between HC and IDA
paths(g, "HC use and type", "IDA")
```
```{r}
impliedConditionalIndependencies(g)
```
## Minimal adjustment set

```{r}
# Minimal adjustment set
print("The minimal adjustment set")
adjustmentSets(g,"HC use and type","IDA")

```

At a minimum, HC contraindications and education level needs to be adjusted for to close biasing paths



